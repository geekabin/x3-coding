### 主子表对象开发代码

```
######################################################################################
## 由系统管理员添加的标签 (对象 YSOH) 2021/06/23 15:58:23 (ADMIN)
######################################################################################
$ACTION
#Onerrgo ERR_HANDLE
Case ACTION
  When "OUVRE"        : Gosub OUVRE               #打开单据时调用，主要是打开环境表，声明环境使用的变量
  When "FILTRE"       : Gosub FILTRE              #加载左列表时，对左列表进行筛选
  When "LIENS"        : Gosub LIENS               #切换左列表对象时，加载数据
  When "CREATION"     : Gosub CREATION            #创建单据时调用
  When "APRES_CRE"    : Gosub APRES_CRE           #创建之后调用
  When "APRES_MOD"    : Gosub APRES_MOD           #修改保存之后滴啊用（写完数据库之后）
  When "MODIF"        : Gosub MODIF               #修改时滴啊用
  When "ANNULE"       : Gosub ANNULE              #删除调用
  When "INICRE"       : Gosub INICRE              #创建初始化，打钩的时候调用
  When "DEFLIG"       : Gosub DEFLIG              
  When "INICRE_LIG"   : Gosub INI_LIG             #行创建写入时调用
  When "INIMOD_LIG"   : Gosub INI_LIG             #行修改写入时调用
  When Default
Endcase
#Onerrgo
Return
######################################################################################
$ERR_HANDLE
Errbox "错误代码："-num$(errn)-"，发生行："-num$(errl)-"，脚本："-errp-"，消息："-errmes$(errn)-"，细节："-errm
Resume   ##Resume表示报错后继续执行，End表示报错后停止执行
######################################################################################
$OUVRE
Gosub DECLARE From TABLEAUX   #初始化
Gosub OPEN_TAB
Return
######################################################################################
$OPEN_TAB
IF !CLALEV([F:YSOH]) LOCAL FILE YSORDER [YSOH] ENDIF   #判断[F:YSOH]是否存在，不存在则开表
Return
######################################################################################
$FILTRE
Default File [F:YSOH]          #定义功能主表
##主对象currbox值为GAU_CHE
##上次读到currbox值为GAU_CHE9
##筛选变量FILTRE/FILTSUP/CRITERE
Return
######################################################################################
$LIENS
  Gosub LIENS From TABLEAUX     #载入屏幕
Return
######################################################################################
$CREATION
  Gosub CREATION From TABLEAUX  #标准创建程序
  If GOK < 1  Return  Endif
Return
######################################################################################
$APRES_CRE
  Gosub LIENS From TABLEAUX   #创建后，重新载入屏幕
Return
######################################################################################
$APRES_MOD
  Gosub LIENS From TABLEAUX   #修改保存后，重新载入屏幕
Return
######################################################################################
$MODIF
  Gosub MODIF From TABLEAUX   #标准修改保存程序
  If GOK < 1  Return  Endif
Return
######################################################################################
$ANNULE
  Gosub ANNULE From TABLEAUX  #标准删除程序
  If GOK < 1  Return  Endif
Return
######################################################################################
$INICRE
  Local Integer STAT
  Call NUMERO ('YSOH',[M:YSOH0]YFCY,date$,"",[M:YSOH0]YSOHNUM,STAT) From SUBANM  #调用序列号定义自动生成单据编码，GSITE为地点字段，如果序列号里面设置了地点这里传参改变
  [F:YSOH]YSOHNUM = [M:YSOH0]YSOHNUM : Affzo [M:YSOH0]YSOHNUM
Return
######################################################################################
$DEFLIG
  Default Mask [M:YSOH1]       #第一个子屏幕
  Default File [F:YSOQ]       #第一个子表
  CRIT    = '[F:YSOQ]YSOHNUM = "' + [M:YSOH0]YSOHNUM + '"'  #字表根据单据号过滤
  FICLIG  = "YSORDERQ"        #第一个子表
  ABLIG   = "YSOQ"            #第一个子表缩写
  ZONLIG  = "LIN"             #第一个子表行号字段编码
Return
######################################################################################
$INI_LIG
  [F:YSOQ]YSOHNUM=[F:YSOH]YSOHNUM   #新建行时，给将单号赋值给子表
Return




$XXXX     #代码块   GOSUB XXXX FROM FILE
RETURN

SUBPROG XABC(W1,W2,W3)    #子程序   CALL XABC(X1,X2,X3)
VALUE CHAR W1
VARIABLE INTEGER W2
VALUE DECIMAL W3

W1 = '我是值传递'

W1 = '我被改掉了'

W2 = 100

W2 = 200

W3 = 15.6

W3 = 17.22
END


FUNPROG FUN_GET_SOHDES(WNUM)  #函数   WRET = func FUN_GET_SOHDES([M:SOH0]DES)
VALUE CHAR WNUM

LOCAL CHAR WDES
WDES = '我是销售订单头备注'
END WDES

LOCAL CHAR WDES
GLOBAL CHAR GYDES


```





try .......





```
# 代码块
$callmeMabey
## coding
Return

# 调用 
Gosub xxxx
Gosub xxx from xxx

#字程序
SUBPROG COUNT_PRO(w1,w2)
VALUE CHAR w1
VALUEABLE INTEGER w2 #传递引用
w1 = 'hi'
w2 = '3000' //影响变量值
END


#函数
W : 块变量
G : 全局变量

FUNPROG FUN_GET_SOHDES(WNUM)  #函数   WRET = func FUN_GET_SOHDES([M:SOH0]DES)
VALUE CHAR WNUM

LOCAL CHAR WDES
WDES = '我是销售订单头备注'
END WDES

LOCAL CHAR WDES
GLOBAL CHAR GYDES


```

