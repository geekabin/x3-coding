### 字表主表关联

```
##销售订单
######################################################################################
$ACTION
#Onerrgo ERR_HANDLE
Case ACTION
  When "OUVRE"        : Gosub OUVRE            
  When "FILTRE"       : Gosub FILTRE
  When "LIENS"        : Gosub LIENS
  When "CREATION"     : Gosub CREATION
  When "APRES_CRE"    : Gosub APRES_CRE
  When "APRES_MOD"    : Gosub APRES_MOD
  When "MODIF"        : Gosub MODIF
  When "ANNULE"       : Gosub ANNULE
  When "INICRE"       : Gosub INICRE
  When "DEFLIG"       : Gosub DEFLIG
  When "INICRE_LIG"   : Gosub INI_LIG
  When "INIMOD_LIG"   : Gosub INI_LIG
  When Default
Endcase
#Onerrgo
Return
######################################################################################
$ERR_HANDLE
Errbox "错误代码："-num$(errn)-"，发生行："-num$(errl)-"，脚本："-errp-"，消息："-errmes$(errn)-"，细节："-errm
Resume   ##Resume表示报错后继续执行，End表示报错后停止执行
######################################################################################
$OUVRE
  Gosub DECLARE From TABLEAUX   #初始化
  Gosub OPEN_TAB
Return
######################################################################################
$OPEN_TAB

Return
######################################################################################
$FILTRE
  Default File [F:YSOH]          #定义功能主表
##主对象currbox值为GAU_CHE
##上次读到currbox值为GAU_CHE9
##筛选变量FILTRE/FILTSUP/CRITERE
Return
######################################################################################
$LIENS
  Gosub LIENS From TABLEAUX     #载入屏幕
Return
######################################################################################
$CREATION
  Gosub CREATION From TABLEAUX  #标准创建程序
  If GOK < 1  Return  Endif
Return
######################################################################################
$APRES_CRE
  Gosub LIENS From TABLEAUX   #创建后，重新载入屏幕
Return
######################################################################################
$APRES_MOD
  Gosub LIENS From TABLEAUX   #修改保存后，重新载入屏幕
Return
######################################################################################
$MODIF
  Gosub MODIF From TABLEAUX   #标准修改保存程序
  If GOK < 1  Return  Endif
Return
######################################################################################
$ANNULE
  Gosub ANNULE From TABLEAUX  #标准删除程序
  If GOK < 1  Return  Endif
Return
######################################################################################
$INICRE
  Local Integer STAT
  Call NUMERO ('YSOH',[M:YSOH0]YFCY,date$,"",[M:YSOH0]YSOHNUM,STAT) From SUBANM  #调用序列号定义自动生成单据编码，GSITE为地点字段，如果序列号里面设置了地点这里传参改变
  [F:YSOH]YSOHNUM = [M:YSOH0]YSOHNUM : Affzo [M:YSOH0]YSOHNUM
Return
######################################################################################
$DEFLIG
  Default Mask [M:YSOH1]       #第一个子屏幕
  Default File [F:YSOQ]       #第一个子表
  CRIT    = '[F:YSOQ]YSOHNUM = "' + [M:YSOH0]YSOHNUM + '"'  #字表根据单据号过滤
  FICLIG  = "YSORDERQ"        #第一个子表
  ABLIG   = "YSOQ"            #第一个子表缩写
  ZONLIG  = "LIN"             #第一个子表行号字段编码
Return
######################################################################################
$INI_LIG
  [F:YSOQ]YSOHNUM=[F:YSOH]YSOHNUM   #新建行时，给将单号赋值给子表
Return
######################################################################################
```

